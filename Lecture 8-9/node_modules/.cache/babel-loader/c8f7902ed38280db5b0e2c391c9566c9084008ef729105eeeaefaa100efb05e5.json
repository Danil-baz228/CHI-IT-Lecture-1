{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axiosInstance from '../../api/axiosInstance';\n\n// Определите интерфейс для ваших учетных данных\n\n// Определите интерфейс для данных пользователя\n\n// Определите интерфейс для состояния\n\n// Функция для регистрации пользователя\nexport const register = createAsyncThunk('user/register', async (credentials, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axiosInstance.post('/users/register', credentials); // Измените путь на ваш\n    return response.data; // Предполагается, что response.data - это объект User\n  } catch (error) {\n    const err = error;\n    console.error(err.response.data);\n    return rejectWithValue(err.response.data);\n  }\n});\n\n// Функция для входа пользователя\nexport const login = createAsyncThunk('user/login', async credentials => {\n  const response = await axiosInstance.post('/api/auth/login', credentials); // Измените путь на ваш\n  return response.data; // Предполагается, что response.data - это объект User\n});\nconst userSlice = createSlice({\n  name: 'user',\n  initialState: {\n    user: null,\n    status: 'idle',\n    error: null\n  },\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(login.fulfilled, (state, action) => {\n      state.user = action.payload; // Теперь это объект User\n      localStorage.setItem('token', action.payload.token); // action.payload.token теперь доступен\n    }).addCase(register.fulfilled, (state, action) => {\n      state.user = action.payload; // Теперь это объект User\n      localStorage.setItem('token', action.payload.token); // action.payload.token теперь доступен\n    }).addCase(register.rejected, (state, action) => {\n      state.error = action.payload; // Явно указываем, что action.payload - это строка\n    });\n  }\n});\nexport default userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axiosInstance","register","credentials","rejectWithValue","response","post","data","error","err","console","login","userSlice","name","initialState","user","status","reducers","extraReducers","builder","addCase","fulfilled","state","action","payload","localStorage","setItem","token","rejected","reducer"],"sources":["C:/Users/user/Desktop/dzInternatura/Lecture8/my-social-app/src/store/slices/userSlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axiosInstance from '../../api/axiosInstance';\r\n\r\n// Определите интерфейс для ваших учетных данных\r\ninterface Credentials {\r\n  username: string; // Или email, если это актуально\r\n  password: string;\r\n}\r\n\r\n// Определите интерфейс для данных пользователя\r\ninterface User {\r\n  token: string;\r\n  // добавьте другие необходимые поля, например, username, email и т. д.\r\n}\r\n\r\n// Определите интерфейс для состояния\r\ninterface UserState {\r\n  user: null | User; // Замените 'object' на User\r\n  status: 'idle' | 'loading' | 'succeeded' | 'failed';\r\n  error: null | string;\r\n}\r\n\r\n// Функция для регистрации пользователя\r\nexport const register = createAsyncThunk<User, Credentials>(\r\n  'user/register',\r\n  async (credentials, { rejectWithValue }) => {\r\n    try {\r\n      const response = await axiosInstance.post('/users/register', credentials); // Измените путь на ваш\r\n      return response.data; // Предполагается, что response.data - это объект User\r\n    } catch (error) {\r\n      const err = error as { response: { data: string } };\r\n      console.error(err.response.data);\r\n      return rejectWithValue(err.response.data);\r\n    }\r\n  }\r\n);\r\n\r\n// Функция для входа пользователя\r\nexport const login = createAsyncThunk<User, Credentials>(\r\n  'user/login',\r\n  async (credentials) => {\r\n    const response = await axiosInstance.post('/api/auth/login', credentials); // Измените путь на ваш\r\n    return response.data; // Предполагается, что response.data - это объект User\r\n  }\r\n);\r\n\r\nconst userSlice = createSlice({\r\n  name: 'user',\r\n  initialState: {\r\n    user: null,\r\n    status: 'idle',\r\n    error: null,\r\n  } as UserState,\r\n  reducers: {},\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(login.fulfilled, (state, action) => {\r\n        state.user = action.payload; // Теперь это объект User\r\n        localStorage.setItem('token', action.payload.token); // action.payload.token теперь доступен\r\n      })\r\n      .addCase(register.fulfilled, (state, action) => {\r\n        state.user = action.payload; // Теперь это объект User\r\n        localStorage.setItem('token', action.payload.token); // action.payload.token теперь доступен\r\n      })\r\n      .addCase(register.rejected, (state, action) => {\r\n        state.error = action.payload as string; // Явно указываем, что action.payload - это строка\r\n      });\r\n  },\r\n});\r\n\r\nexport default userSlice.reducer;\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,aAAa,MAAM,yBAAyB;;AAEnD;;AAMA;;AAMA;;AAOA;AACA,OAAO,MAAMC,QAAQ,GAAGF,gBAAgB,CACtC,eAAe,EACf,OAAOG,WAAW,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAC1C,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMJ,aAAa,CAACK,IAAI,CAAC,iBAAiB,EAAEH,WAAW,CAAC,CAAC,CAAC;IAC3E,OAAOE,QAAQ,CAACE,IAAI,CAAC,CAAC;EACxB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,MAAMC,GAAG,GAAGD,KAAuC;IACnDE,OAAO,CAACF,KAAK,CAACC,GAAG,CAACJ,QAAQ,CAACE,IAAI,CAAC;IAChC,OAAOH,eAAe,CAACK,GAAG,CAACJ,QAAQ,CAACE,IAAI,CAAC;EAC3C;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMI,KAAK,GAAGX,gBAAgB,CACnC,YAAY,EACZ,MAAOG,WAAW,IAAK;EACrB,MAAME,QAAQ,GAAG,MAAMJ,aAAa,CAACK,IAAI,CAAC,iBAAiB,EAAEH,WAAW,CAAC,CAAC,CAAC;EAC3E,OAAOE,QAAQ,CAACE,IAAI,CAAC,CAAC;AACxB,CACF,CAAC;AAED,MAAMK,SAAS,GAAGb,WAAW,CAAC;EAC5Bc,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,MAAM;IACdR,KAAK,EAAE;EACT,CAAc;EACdS,QAAQ,EAAE,CAAC,CAAC;EACZC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACT,KAAK,CAACU,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC3CD,KAAK,CAACP,IAAI,GAAGQ,MAAM,CAACC,OAAO,CAAC,CAAC;MAC7BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,MAAM,CAACC,OAAO,CAACG,KAAK,CAAC,CAAC,CAAC;IACvD,CAAC,CAAC,CACDP,OAAO,CAAClB,QAAQ,CAACmB,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC9CD,KAAK,CAACP,IAAI,GAAGQ,MAAM,CAACC,OAAO,CAAC,CAAC;MAC7BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,MAAM,CAACC,OAAO,CAACG,KAAK,CAAC,CAAC,CAAC;IACvD,CAAC,CAAC,CACDP,OAAO,CAAClB,QAAQ,CAAC0B,QAAQ,EAAE,CAACN,KAAK,EAAEC,MAAM,KAAK;MAC7CD,KAAK,CAACd,KAAK,GAAGe,MAAM,CAACC,OAAiB,CAAC,CAAC;IAC1C,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,eAAeZ,SAAS,CAACiB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}